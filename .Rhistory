source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
install.packages("cowplot")
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
help(get_legend)
print(altissima)
help(plot_grid)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
install.packages("ggforce")
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
metaboliteColors
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
View(rawData)
View(allData)
legend
View(legend)
print(legend)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(altissimaRootData)
levels(altissimaRootData$metabolite)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
help(geom_arc_bar)
metaboliteOrder
View(altissimaRootData)
View(allData)
levels(allData$metabolite)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
plot_grid(rootHeatmap, shootHeatmap, leafHeatmap, nrow=1, ncol=3)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
plot_grid(rootHeatmap, shootHeatmap, leafHeatmap, nrow=1, ncol=3)
View(organData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(organData)
organData$Leaves
view(organData$Leaves)
debugSource('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
debugSource('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
debugSource('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(organData)
View(organData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
help(filter)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
plot_grid(rootHeatmap, shootHeatmap, leafHeatmap, nrow=1, ncol=3)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(pieSizes)
View(pieSizes)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
levels(altissimaRootData)
levels(altissimaRootData$metabolite)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
print(createHeatmap(allData, "Roots"))
print(createHeatmap(allData, "Leaves"))
listData <- NULL
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
metaboliteColors
View(allData)
levels(allData$variety)[1]
View(allData)
levels(organ)
levels(allData$organ)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
legend <- createLegend(allData, metaboliteColors, "horizontal")
View(legend)
print(plot_grid(altissimaRoot, altissimaShoot, altissimaLeaf, legend,
nrow=2, ncol=3,
labels=c("Root", "Shoot", "Leaf"), label_x=0, label_y=1, label_size=14,
rel_widths=c(pieSizes$radius[1], pieSizes$radius[2], pieSizes$radius[3]),
rel_heights=c(pieSizes$radius[1], pieSizes$radius[2], pieSizes$radius[3])
))
names(metaboliteColors)
paste(seq(1, 15), names(metaboliteColors))
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
paste(seq(1, 15), ". ", names(metaboliteColors))
paste(seq(1, 15), ". ", names(metaboliteColors), sep="")
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
legend <- createLegend(allData, metaboliteColors, legendOrientation="horizontal")
legend <- createLegend(allData, metaboliteColors, "horizontal")
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
legend <- createLegend(allData, metaboliteColors, legendOrientation="horizontal")
print(plot_grid(altissimaRoot, altissimaShoot, altissimaLeaf, legend,
nrow=2, ncol=3,
labels=c("Root", "Shoot", "Leaf"), label_x=0, label_y=1, label_size=14,
rel_widths=c(pieSizes$radius[1], pieSizes$radius[2], pieSizes$radius[3]),
rel_heights=c(pieSizes$radius[1], pieSizes$radius[2], pieSizes$radius[3])
))
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
print(pies)
print(legend)
source('~/woundingResponse/pixelHistograms.R')
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
View(pixelData)
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
help(gather)
source('~/woundingResponse/pixelHistograms.R')
help(gather)
source('~/woundingResponse/pixelHistograms.R')
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
help(ddply)
source('~/woundingResponse/pixelHistograms.R')
help(ddply)
source('~/woundingResponse/pixelHistograms.R')
View(pixelMeans)
source('~/woundingResponse/pixelHistograms.R')
View(pixelMeans)
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(control)
source('~/woundingResponse/pixelHistograms.R')
print(control)
View(control)
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(mel_1000ppm)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
sd(pixelData$value)
source('~/woundingResponse/pixelHistograms.R')
View(pixelMeans)
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
source('~/woundingResponse/pixelHistograms.R')
print(controlThresholds)
View(pixelData)
source('~/woundingResponse/pixelHistograms.R')
View(sampleData)
source('~/woundingResponse/pixelHistograms.R')
print(pinkingProgress)
source('~/woundingResponse/pixelHistograms.R')
print(pinkingProgress)
source('~/woundingResponse/pixelHistograms.R')
print(pinkingProgress)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
print(pinkingProgress)
source('~/woundingResponse/pixelHistograms.R')
print(pinkingProgress)
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/woundingResponse/pixelHistograms.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
levels(allData$variety)
rev(levels(allData$variety))
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_KR.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_KR.R')
View(allData)
levels(allData$organ)
allData <- filter(allData, organ =! "Flowers")
allData <- filter(allData, organ == "Leaves" | organ == "Shoots" | organ == "Roots")
levels(allData$organ)
allData$organ <- factor(allData$organ)
levels(allData$organ)
levels(allData$variety)
rev(levels(allData$variety))
plottingData <- allData
plottingData$variety <- factor(plottingData$variety)
# Calculate size of pies based on total amount of metabolites -------------------------------------
pieSizes <- ddply(plottingData, c("variety", "organ"), summarise, area=sum(meanConc))
pieSizes <- transform(pieSizes, radius=sqrt(area/pi))
pieSizes <- transform(pieSizes, scaledRadius=pieSizes$radius/max(radius))
# For loop to create list of pie charts for plotting ----------------------------------------------
allPies <- vector("list", length=length(levels(plottingData$variety))*3)
i = 0
for(variety in levels(plottingData$variety)){
for(organ in levels(plottingData$organ)){
i = i + 1
allPies[[i]] <- local({
i <- i
pieRadius <- pieSizes[which(pieSizes$variety == variety & pieSizes$organ == organ), 5]
pieChart <- createPieChart(plottingData, metaboliteColors, variety, organ, size=pieRadius)
})
names(allPies)[i] <- paste(variety, organ)
}
}
legend <- createLegend(allData, metaboliteColors)
justPies <- plot_grid(plotlist=allPies,
ncol=3)
y.grob <- textGrob("KR Strigillosa KR Pekinesis KR Insignis KR Dependens KR Barbata KR Indica RNA Seq Racemosa SC Racemosa MS Racemosa 071119 Tournefortii Lateriflora Hastafolia Barbata Baicalensis Arenicola Altissima",
gp=gpar(fontface="bold", col="black", fontsize=14), rot=90)
x.grob <- textGrob("Roots Shoots Leaves",
gp=gpar(fontface="bold", col="black", fontsize=14))
justPies <- grid.arrange(arrangeGrob(justPies, left=y.grob, top=x.grob))
finalFigure <- plot_grid(justPies, legend,
nrow=2, ncol=1,
rel_heights=c(1, 0.05))
print(finalFigure)
length(levels(allData$variety))
library(OpenImageR)
image <- readImage("C:/Users/Bryce/Documents/woundingResponse/data/woundingSites/romaine_control_5_A-5")
image <- readImage("C:/Users/Bryce/Documents/woundingResponse/data/woundingSites/romaine_control_5_A-5.png")
source('~/woundingResponse/code/reduceArea.R')
imageShow(image)
image[ , , 4] == 1
image[ , , 4] == 0
image[ , 1550, 4] == 0
image[ , 1550, 4] == 1
source('~/woundingResponse/code/sdMethod.R')
source('~/woundingResponse/code/sdMethod.R')
getwd()
setwd("C:/Users/bca08_000/Documents/woundingResponse")
getwd()
setwd("C:/Users/bca08_000/Documents/woundingResponse")
source('~/woundingResponse/code/sdMethod.R')
geom_col(position="dodge") +
geom_errorbar(aes(ymin=mean1_3-stError1_3, ymax=mean1_3+stError1_3), width=0.4, position=position_dodge(.9)) +
labs(title="Change in pctPink from day 1 to day 3", x="Variety", y="Mean difference in average pctPink of wounding site") +
ylim(-2, 50) +
theme(plot.title=element_text(size=18),
axis.title.x=element_text(size=14),
axis.title.y=element_text(size=14),
axis.text=element_text(size=12))
print(day1_3Plot)
day1_5Plot <- ggplot(data=meanDiffData, mapping=aes(x=variety, y=mean1_5, fill=treatment)) +
geom_col(position="dodge") +
geom_errorbar(aes(ymin=mean1_5-stError1_5, ymax=mean1_5+stError1_5), width=0.4, position=position_dodge(.9)) +
labs(title="Change in pctPink from day 1 to day 5", x="Variety", y="Mean difference in average pctPink of wounding site") +
ylim(-2, 50) +
theme(plot.title=element_text(size=18),
axis.title.x=element_text(size=14),
axis.title.y=element_text(size=14),
axis.text=element_text(size=12))
print(day1_5Plot)
day1_3Plot <- ggplot(data=meanDiffData, mapping=aes(x=variety, y=mean1_3, fill=treatment)) +
geom_col(position="dodge") +
geom_errorbar(aes(ymin=mean1_3-stError1_3, ymax=mean1_3+stError1_3), width=0.4, position=position_dodge(.9)) +
labs(title="Change in pctPink from day 1 to day 3", x="Variety", y="Mean difference in average pctPink of wounding site") +
ylim(-2, 50) +
theme(plot.title=element_text(size=18),
axis.title.x=element_text(size=14),
axis.title.y=element_text(size=14),
axis.text=element_text(size=12))
print(day1_3Plot)
day1_5Plot <- ggplot(data=meanDiffData, mapping=aes(x=variety, y=mean1_5, fill=treatment)) +
geom_col(position="dodge") +
geom_errorbar(aes(ymin=mean1_5-stError1_5, ymax=mean1_5+stError1_5), width=0.4, position=position_dodge(.9)) +
labs(title="Change in pctPink from day 1 to day 5", x="Variety", y="Mean difference in average pctPink of wounding site") +
ylim(-2, 50) +
theme(plot.title=element_text(size=18),
axis.title.x=element_text(size=14),
axis.title.y=element_text(size=14),
axis.text=element_text(size=12))
print(day1_5Plot)
