# Read metabolite data from .csv file -------------------------------------------------------------
rawData <- read.csv(file="C:/Users/Bryce/Documents/scutellariaMetabolites/data/metaboliteDataHerbarium1-30.csv", na.strings=c("", "NA"), header=TRUE)
rawData[, 1] <- as.character(rawData[, 1])
# Define functions for interpreting injection names -----------------------------------------------
herbariumList <- read.csv(file="C:/Users/Bryce/Documents/scutellariaMetabolites/data/herbariumList.csv")
getSampleName <- function(injectionName, nameList){
sampleName <- nameList[injectionName==nameList$Label, 3]
return(sampleName)
}
# Define function to convert peak area data into ppm using calibration samples --------------------
ppmConversion <- function(peakArea, metaboliteName, mix1Rows, mix2Rows, rawData=rawData){
if(sum(grepl(metaboliteName, colnames(rawData)[2:9]))==1){ #metabolite is in mix 1
calibrations <- data.frame(ppm=c(0.1, 0.5, 1, 5, 10, 25, 50, 100), area=rawData[[metaboliteName]][mix1Rows])
}else{ #metabolite is in mix 2
calibrations <- data.frame(ppm=c(0.1, 0.5, 1, 5, 10, 25, 50, 100), area=rawData[[metaboliteName]][mix2Rows])
}
convFactor <- lm(formula=ppm~area+0, data=calibrations)[[1]][[1]]
ppm <- peakArea*convFactor
return(ppm)
}
rawData <- rawData[!grepl("15mix", rawData$injection), ]
row.names(rawData) <- 1:nrow(rawData)
View(rawData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
sapply(rawData$injection[29:72], getSampleName, nameList=herbariumList)
sapply(rawData$apigenin[29:72], ppmConversion, metaboliteName="apigenin", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
rawData$apigenin[29:72]
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(rawData)
sapply(rawData$apigenin[29:72], ppmConversion, metaboliteName="apigenin", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
sapply(rawData$apigeninG[29:72], ppmConversion, metaboliteName="apigeninG", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
sapply(rawData$injection[29:72], getSampleName, nameList=herbariumList)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
wogonin=sapply(rawData$wogonin[29:72], ppmConversion, metaboliteName="wogonin", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
wogonoside=sapply(rawData$wogonoside[29:72], ppmConversion, metaboliteName="wogonoside", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
baicalein=sapply(rawData$baicalein[29:72], ppmConversion, metaboliteName="baicalein", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
baicalin=sapply(rawData$baicalin[29:72], ppmConversion, metaboliteName="baicalin", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
oroxylinA=sapply(rawData$oroxylinA[29:72], ppmConversion, metaboliteName="oroxylinA", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
oroxyloside=sapply(rawData$oroxyloside[29:72], ppmConversion, metaboliteName="oroxyloside", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData),
acetoside=sapply(rawData$acetoside[29:72], ppmConversion, metaboliteName="acetoside", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
apigeninG=sapply(rawData$apigeninG[29:72], ppmConversion, metaboliteName="apigeninG", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
scutellarein=sapply(rawData$scutellarein[29:72], ppmConversion, metaboliteName="scutellarein", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData)
warnings()
apigenin=sapply(rawData$apigenin[29:72], ppmConversion, metaboliteName="apigenin", mix1Rows=11:18, mix2Rows=20:27, rawData=rawData)
View(rawData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(rawData)
View(allData)
View(rawData)
View(rawData)
View(rawData)
View(allData)
View(allData)
View(allData)
colnames(allData)[2:16]
allData %>%
group_by(variety) %>%
for(metabolite in colnames(allData)[2:16]){
summarize(metabolite=mean(metabolite))
}
allData %>%
group_by(variety) %>%
for(metabolite in colnames(allData)[2:16]){
summarize(metabolite=mean(metabolite))
}
install.packages("analytics")
library(analytics)
rowmean(allData, group=variety)
View(allData)
rowmean(allData, group="variety")
View(allData)
rowmean(allData, group="1")
?aggregate
testData <- aggregate(allData[ , c(2:16)], by=allData$variety, mean, na.rm=TRUE)
testData <- aggregate(allData[ , c(2:16)], by=list(allData$variety), mean, na.rm=TRUE)
View(testData)
View(allData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R', echo=TRUE)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R', echo=TRUE)
View(allData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData)
View(allData)
help(gather)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
help(gather)
View(allData)
testData <- gather(allData, key=2:16)
library(tidyr)
testData <- gather(allData, key=2:16)
View(allData)
testData <- allData %>% gather(metabolite, 2:16)
View(rawData)
testData <- allData %>% gather(metabolite, )
View(testData)
View(allData)
testData <- allData %>% gather(metabolite, apigenin:acetoside)
testData <- allData %>% gather(metabolite, colnames(allData)[2:16])
testData <- gather(allData, "metabolite", "concentration", 2:16)
View(testData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R', echo=TRUE)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R', echo=TRUE)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
View(allData)
View(allData)
allData1 <- allData[, c(4:6)]
View(allData1)
allData1 <- allData[, -c(4:6)]
View(allData1)
View(allData)
allData1 <- allData[ , -c(4:6, 8)]
View(allData1)
View(allData1)
View(allData1)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc), n=n())
View(allData1)
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc))
View(allData1)
View(allData)
View(allData)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc)) %>%
filter(!grepl(c("Racemosa MS", "Racemosa SC", "Racemosa 071119"), variety))
View(allData1)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
varietiesToRemove <- paste(c("Racemosa MS", "Racemosa SC", "Racemosa 0711190"), collape="|")
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc)) %>%
filter(!grepl(varietiesToRemove, variety))
View(allData1)
View(allData1)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
varietiesToRemove <- paste(c("Racemosa MS", "Racemosa SC", "Racemosa 0711190"), collape="|")
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc)) %>%
filter(!grepl("Racemosa MS", variety))
View(allData1)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc)) %>%
filter(!grepl("Racemosa MS", variety)) %>%
filter(!grepl("Racemosa SC", variety)) %>%
filter(!grepl("Racemosa 071119", variety))
View(allData1)
levels(allData1$variety)
allData1 <- droplevels(allData1$variety)
levels(allData1$variety)
allData1 <- allData
allData1 <- allData1[ , -c(4:6, 8)]
allData1 <- allData1 %>%
group_by(variety, metabolite) %>%
summarise(concentration=mean(meanConc)) %>%
filter(!grepl("Racemosa MS", variety)) %>%
filter(!grepl("Racemosa SC", variety)) %>%
filter(!grepl("Racemosa 071119", variety))
allData1$variety <- factor(allData1$variety)
levels(allData1$variety)
heatmap <- ggplot(data=organData) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=meanConc)) +
scale_fill_gradientn(colours=colorScale) +
coord_fixed() +
labs(title=plotTitle, x="Variety", y="Metabolite", fill="Conc (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1))
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
colnames(allData1) <- colnames(allData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
allData1 <- allData
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
allData1 <- allData
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData1)
View(allData)
allData <- rbind(allData, allData1)
View(allData)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
allData1 <- allData
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
allData2 <- rbind(allData, allData1)
View(allData)
View(allData2)
allData2 <- dplyr::bind_rows(allData, allData1)
View(allData2)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
allData1 <- allData
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData2)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
allData1 <- allData
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allData2)
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
allDataTotal <- allDataTotal %>%
filter(!grepl("Racemosa MS", variety)) %>%
filter(!grepl("Racemosa SC", variety)) %>%
filter(!grepl("Racemosa 071119", variety))
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Herbarium sample 1-30 flavonoid concetrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16))
return(heatmap)
print(heatmap)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Herbarium sample 1-30 flavonoid concetrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16))
print(heatmap)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
levels(allDataTotal)
levels(allDataTotal$variety)
levels(allDataTotal$variety)[29] <- "racemosa"
levels(allDataTotal$variety)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Herbarium sample 1-30 flavonoid concetrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16))
print(heatmap)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Total flavonoid concentrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16))
print(heatmap)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Total flavonoid concentrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16), legend.position="bottom")
print(heatmap)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
View(allData)
View(allData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
View(allData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
View(allData)
levels(allData$variety)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
View(allData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(createStackedBars(allData, metaboliteColors, "Leaves"))
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
View(allData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(createStackedBars(allData, metaboliteColors, "Roots"))
print(createStackedBars(allData, metaboliteColors, "Leaves"))
library(ggrepel)
install.packages("ggrepel")
library(ggrepel)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
organData <- allData %>%
filter(grepl(plantOrgan, organ)) %>%
group_by(species) %>%
mutate(texy_y = cumsum(meanConc) - meanConc/2)
organData <- allData %>%
filter(grepl("Leaves", organ)) %>%
group_by(species) %>%
mutate(texy_y = cumsum(meanConc) - meanConc/2)
View(organData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(rootPlot)
print(createLegend(allData, metaboliteColors))
leafGrob <- textGrob("Leaves", gp=gpar(fontface="bold", col="black", fontsize=14), rot=90)
print(leafGrob)
print(rootPlot)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
warnings()
help(plot_grid)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
print(justData)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Total flavonoid concentrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1), text=element_text(size=16, color="#000000"), legend.position="bottom")
# TODO: Change color of names to black, replace variety with species, and capitalize first letter of each metabolite
print(heatmap)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(title="Total flavonoid concentrations", x="Variety", y="Metabolite", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1, color="#000000"), text=element_text(size=16, color="#000000"), legend.position="bottom")
# TODO: Change color of names to black, replace variety with species, and capitalize first letter of each metabolite
print(heatmap)
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=metabolite, y=variety, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(x="Metabolite", y="Variety", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1, color="#000000"), text=element_text(size=16, color="#000000"), legend.position="bottom")
# TODO: Change color of names to black, replace variety with species, and capitalize first letter of each metabolite
print(heatmap)
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
source('~/scutellariaMetabolites/code/stackedBarPlots.R')
revalue(allData, c("hastafolia"="hastifolia"))
revalue(allData$species, c("hastafolia"="hastifolia"))
View(allData)
levels(allData$species)[levels(allData$species)=="hastafolia"] <- "hastifolia"
View(allData)
levels(allDataTotal$species)[levels(allDataTotal$species)=="hastafolia"] <- "hastifolia"
# Define function to capitalize first letter of a string
capStr <- function(y) {
c <- strsplit(y, " ")[[1]]
paste(toupper(substring(c, 1,1)), substring(c, 2),
sep="", collapse=" ")
}
allData$metabolite <- sapply(allData$metabolite, capStr)
allData$metabolite
sapply(allData$metabolite, capStr)
sapply(allData$metabolite, capStr)
sapply(as.character(allData$metabolite), capStr)
allData$metabolite <- factor(sapply(as.character(allData$metabolite), capStr))
View(allData)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
View(allDataTotal)
allDataTotal$metabolite <- factor(sapply(as.character(allDataTotal$metabolite), capStr))
levels(allDataTotal$variety)[levels(allDataTotal$variety)=="hastafolia"] <- "hastifolia"
heatmap <- ggplot(data=allDataTotal) +
geom_raster(mapping=aes(x=variety, y=metabolite, fill=concentration)) +
scale_fill_gradientn(colours=c("#FFFFFFFF", "#0066CC")) +
coord_fixed() +
labs(x="Metabolite", y="Species", fill="Concentration (ppm)") +
theme(axis.text.x=element_text(angle=90, vjust=0.5, hjust=1, color="#000000"), text=element_text(size=16, color="#000000"), legend.position="bottom")
print(heatmap)
source('~/scutellariaMetabolites/code/dataVisHPLC_v2.R')
source('~/scutellariaMetabolites/code/herbariumHeatmap.R')
source('~/woundingResponse/code/makeLineGraph.R')
source('~/woundingResponse/code/makeLineGraph.R')
source('~/woundingResponse/code/makeLineGraph.R')
romaineControl <- makeLineGraph(rawData, "romaine", "control)
romaineControl <- makeLineGraph(rawData, "romaine", "control")
print(romaineControl)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-10, upperLim=10)
print(romaineControl)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-10, upperLim=5)
print(romaineControl)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=5)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=5)
printCys500
print(Cys500)
print(romaineCys500)
View(rawData)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-10, upperLim=10)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=10)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=10)
print(romaineControl)
print(romaineCys500)
print(romaineMel1000)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-10, upperLim=10)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=10)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "mel1000", lowerLim=-10, upperLim=10)
print(romaineControl)
print(romaineCys500)
print(romaineMel1000)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-10, upperLim=15)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-10, upperLim=15)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "mel1000", lowerLim=-10, upperLim=15)
print(romaineControl)
print(romaineCys500)
print(romaineMel1000)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-15, upperLim=15)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-15, upperLim=15)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "mel1000", lowerLim=-15, upperLim=15)
print(romaineControl)
print(romaineCys500)
print(romaineMel1000)
romaineMel1000 <- makeLineGraph(rawData, "romaine", "mel1000", lowerLim=-12, upperLim=10)
romaineControl <- makeLineGraph(rawData, "romaine", "control", lowerLim=-12, upperLim=10)
romaineCys500 <- makeLineGraph(rawData, "romaine", "cys500", lowerLim=-12, upperLim=10)
print(romaineControl)
print(romaineCys500)
print(romaineMel1000)
